<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Responsive Globe Visualization</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Stylesheets and scripts will be included here -->
  <style>
  /* Global Styles */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  overflow: hidden;
  font-family: "Syne", sans-serif;
}
	  /* Info and Credits */
    #info, #credits {
      position: absolute;
      width: 100%;
      text-align: center;
      color: teal;
      z-index: 1;
    }

#info {
  bottom: 7.25vh;
}

#credits {
  bottom: 4.5vh;
}
	  #credits a {
      color: #1e90ff;
      text-decoration: none;
    }

    #credits a:hover {
      text-decoration: underline;
    }

/* Tickers */
/* Ticker */
    #dayTicker, #nightTicker {
      display: block;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 50px;
      font-family: Monospace;
      text-align: center;
      z-index: 9999;
      border: none;
      padding: 0;
      margin: 0;
      display: block;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
	  /* Button Style */
    #toggleButton {
      position: absolute;
      right: 0px;
      top: 55px;
      padding: 4.5px 9.5px;
      font-size: 12px;
      background-color: rgba(225, 225, 225, 0.25);
      border: 1px solid rgba(225, 225, 225, 0.25);
      border-radius: 8px;
      color: rgba(155, 155, 155, 0.5);
      z-index: 9999;
      cursor: pointer;
    }
	  #toggleButton:hover {
      background-color: rgba(225, 225, 225, 0.35);
    }

    /* Remove scrollbar from iframes */
    iframe::-webkit-scrollbar {
      display: none;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      /* Adjust the size and placement of the globe on mobile */
      #toggleButton {
        font-size: 10px;
        padding: 3px 7px;
        top: 50px;
      } 
      #dayTicker, #nightTicker {
        height: 40px; /* Reduce height for mobile */
        font-size: 12px;
      }

      #credits {
        /*font-size: 0.6rem;*/ /* Make credits even smaller on mobile */
      }

      /* Adjust globe view on smaller devices by zooming out */
      body {
        overflow: hidden;
      }
    }


/* Marker Labels */
/*.marker-label {
  position: absolute;
  object-fit: contain;
  font-family: 'Space Mono', monospace;
  transition: opacity 0.3s;
  background: transparent;
  width: 142px;
  height: 186px;
  border: 4px solid rgb(0, 107, 63);
  border-radius: 10px;
  z-index: 10;
  margin: 0;
  padding: 0;
  display: none; /* Hidden by default */
}*/

/*.marker-label .close-button {
  position: absolute;
  top: 25px;
  left: 20px;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid lightgray;
  border-radius: 3px;
  color: white;
  font-size: 14px;
  font-weight: bold;
  opacity: 0.25;
  transition: opacity 0.3s;
  cursor: pointer;
  z-index: 11;
}*/
	  
/* Marker Labels */
    /* Marker Labels */
.marker-label {
  position: absolute;  /* Positioned relative to the viewport */
  display: none;  /* Hidden by default */
  transition: opacity 0.5s ease;  /* Smooth fade in/out */
  background-color: rgba(255, 255, 255, 0.9);  /* Slightly translucent background */
  padding: 10px;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);  /* Add shadow for better visibility */
  z-index: 9999;
}
	  .marker-label.active {
      display: block;
    }
	  /* For small screen devices */
@media (max-width: 768px) {
  .marker-label {
    font-size: 0.8rem;  /* Reduce font size on mobile */
    padding: 6px;  /* Smaller padding for mobile */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);  /* Adjust shadow for mobile */
  }
}
	  /* Footer Styles */
    footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      background-color: #222;
      color: #fff;
      text-align: center;
      padding: 10px 0;
      font-size: 0.9rem;
      z-index: 9999;
    }
/* Close button styles (if used) */
.marker-label .close-button {
  position: absolute;
  top: 5px;
  right: 5px;
  background: rgba(0, 0, 0, 0.5);
  color: white;
  border: none;
  border-radius: 3px;
  padding: 5px;
  font-size: 12px;
  cursor: pointer;
}

.marker-label .close-button:hover {
  background-color: rgba(0, 0, 0, 0.8);
}
    footer a {
      color: #1e90ff;
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    /* Responsive Footer for Mobile */
    @media (max-width: 768px) {
      footer {
        font-size: 0.8rem;
        padding: 8px 0;
      }
    }
</style>
	<meta name="google-adsense-account" content="ca-pub-5689710336620898">
	   <script async src="https://fundingchoicesmessages.google.com/i/pub-5689710336620898?ers=1"></script><script>(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();</script>
</head>
<body>
<div id="labels-container"></div>
  <!-- Info Section -->
  <div id="info">Click the markers to show the label</div>
  <div id="credits">
    Made by
    <a href="https://www.linkedin.com/in/shange-fagan-bba3a3239/" target="_blank" rel="noopener">Shange Fagan</a>
  </div>

	 <!-- Footer Section -->
  <footer>
    Â© 2024 World News Hub. All rights reserved. 
    <a href="https://www.linkedin.com/in/shange-fagan-bba3a3239/" target="_blank">LinkedIn</a> | 
    <a href="https://instagram.com/shangefagan" target="_blank">Instagram</a>
  </footer>

  <!-- Marker Labels (Will be dynamically generated) -->
  <div id="labels-container"></div>

  <!-- Tickers -->
  <iframe
    id="dayTicker"
    src="https://rss.app/embed/v1/ticker/ye6DcnVZx4IHEsUK"
    frameborder="0"
    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox"
  ></iframe>
  <iframe
    id="nightTicker"
    src="https://rss.app/embed/v1/ticker/ye6DcnVZx4IHEsUK"
    frameborder="0"
    style="display: none;"
    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox"
  ></iframe>
  <iframe
    id="nightTicker"
    src="https://rss.app/embed/v1/ticker/ye6DcnVZx4IHEsUK"
    frameborder="0"
    style="display: none;"
    sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox"
  ></iframe>
  <!-- Import Map -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.136.0/build/three.module.js",
      "three/examples/jsm/controls/OrbitControls": "https://unpkg.com/three@0.136.0/examples/jsm/controls/OrbitControls.js",
      "three/examples/jsm/renderers/CSS2DRenderer": "https://unpkg.com/three@0.136.0/examples/jsm/renderers/CSS2DRenderer.js",
      "three/examples/jsm/loaders/RGBELoader": "https://unpkg.com/three@0.136.0/examples/jsm/loaders/RGBELoader.js"
    }
  }
  </script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5689710336620898"
     crossorigin="anonymous"></script>
<button id="toggleButton">Switch to Night</button>
  <!-- Scripts -->
  <!-- Include Three.js and other dependencies here -->

  <!-- Main JavaScript -->
  <script type="module">
    // JavaScript code will go here
    import * as THREE from "three";
  import { OrbitControls } from "https://cdn.skypack.dev/three@0.136.0/examples/jsm/controls/OrbitControls";
  import {
    CSS2DRenderer,
    CSS2DObject,
  } from "https://cdn.skypack.dev/three@0.136.0/examples/jsm/renderers/CSS2DRenderer.js";
    import { RGBELoader } from 'https://cdn.jsdelivr.net/npm/three@0.136.0/examples/jsm/loaders/RGBELoader.js';
  
  // Scene Setup
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(45, innerWidth / innerHeight, 1, 2000);
  camera.position.set(20, 0.5, 15).setLength(17);
  
  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(innerWidth, innerHeight);
  renderer.setPixelRatio(window.devicePixelRatio);
  document.body.appendChild(renderer.domElement);
  
  // Label Renderer
  const labelRenderer = new CSS2DRenderer();
  labelRenderer.setSize(innerWidth, innerHeight);
  labelRenderer.domElement.style.position = 'absolute';
  labelRenderer.domElement.style.top = '0px';
  document.body.appendChild(labelRenderer.domElement);
  
  // Controls
  const controls = new OrbitControls(camera, labelRenderer.domElement);
  controls.enableDamping = true;
  controls.dampingFactor = 0.25;
  controls.enableZoom = true;
  controls.minDistance = 15;
  controls.maxDistance = 20;
  controls.autoRotate = true;
  controls.autoRotateSpeed = 0.25;

   // Lighting - Reduced intensity to reduce glare
    /*const ambientLight = new THREE.AmbientLight(0xffffff, 0.6); // Soft ambient light
    scene.add(ambientLight);

    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.4); // Reduced intensity
    directionalLight.position.set(5, 5, 5); // Adjust position
    scene.add(directionalLight);*/
  
  // Global Uniforms
  const globalUniforms = {
    time: { value: 0 },
  };
  
  // Handle Window Resize
  window.addEventListener('resize', onWindowResize);
  
  function onWindowResize() {
    camera.aspect = innerWidth / innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
    labelRenderer.setSize(innerWidth, innerHeight);
  }
    // Track loaded textures
let texturesLoaded = 0;
const totalTextures = 4; // Update this if you have more or fewer textures

function checkTexturesLoaded() {
  texturesLoaded++;
  if (texturesLoaded === totalTextures) {
    animate(); // Start animation after all textures are loaded
  }
}
    //let dayTexture, nightTexture;
    let isDay = true; // Track whether it's currently day or night

// Load Textures
const textureLoader = new THREE.TextureLoader();

// Background Texture
    /*const loader = new THREE.TextureLoader();
loader.load('js/0f2dd307-0d28-4fe9-9ef9-db84277033dd_hdr3.png', function (texture) {
  const rt = new THREE.WebGLCubeRenderTarget(texture.image.height);
  rt.fromEquirectangularTexture(renderer, texture);
  scene.background = rt.texture;
});*/
	  const sphereWidth = 5.1;
  const sphereHeight = 32.1;
  const sphereDepth = 32.1;
  const geometry = new THREE.SphereGeometry(
    sphereWidth,
    sphereHeight,
    sphereDepth
  );
	  const sphereWidth2 = 5.099;
  const sphereHeight2 = 32.1;
  const sphereDepth2 = 32.1;
  const geometry2 = new THREE.SphereGeometry(
    sphereWidth2,
    sphereHeight2,
    sphereDepth2
  );
	  const dayTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-blue-marble.jpg");
	  const dayBumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
	    const nightTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-night.jpg");
const bumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
  const specularMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-water.png");
		//const dayBumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
const nightBumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
  

	  // Create the material
const material2 = new THREE.MeshPhongMaterial({
  specular: 0x111111,
  shininess: 5,
  map: dayTexture, // Start with day texture
  specularMap: textureLoader.load("//unpkg.com/three-globe/example/img/earth-water.png"),
  bumpMap: dayBumpMap, // Start with day bump map
  bumpScale: 0.35,
  blending: THREE.AdditiveBlending,
});

	  // Load the Cube Map
      const cubeTextureLoader = new THREE.CubeTextureLoader();
	  //let isMobile = /Mobi/i.test(navigator.userAgent);
let globe2 = new THREE.Mesh(geometry, material2);
	  // Responsive Globe for Mobile
    let isMobile = window.innerWidth <= 768;
    if (isMobile) {
      camera.fov = 60;  // Increase FOV to zoom out on mobile
      camera.updateProjectionMatrix();
      //globe2.scale.set(0.9, 0.9, 0.9); // Slightly scale down the globe
    }

/*const cubeMap = cubeTextureLoader.load([
  isMobile ? 'js/px.webp' : 'js/px.png', // Right face
  isMobile ? 'js/nx.webp' : 'js/nx.png', // Left face
  isMobile ? 'js/py.webp' : 'js/py.png', // Top face
  isMobile ? 'js/ny.webp' : 'js/ny.png', // Bottom face
  isMobile ? 'js/pz.webp' : 'js/pz.png', // Front face
  isMobile ? 'js/nz.webp' : 'js/nz.png'  // Back face
]);*/
	  // Load Cube Maps for Background
    //const cubeTextureLoader = new THREE.CubeTextureLoader();
    const dayCubeMap = cubeTextureLoader.load([
     isMobile ? 'js/px.webp' : 'js/px.png', // Right face
  isMobile ? 'js/nx.webp' : 'js/nx.png', // Left face
  isMobile ? 'js/py.webp' : 'js/py.png', // Top face
  isMobile ? 'js/ny.webp' : 'js/ny.png', // Bottom face
  isMobile ? 'js/pz.webp' : 'js/pz.png', // Front face
  isMobile ? 'js/nz.webp' : 'js/nz.png'  // Back face
    ]);
    const nightCubeMap = cubeTextureLoader.load([
      isMobile ? 'js/px_(1).webp' : 'textures/px_(1).png', // Right face
  isMobile ? 'js/nx_(1).webp' : 'textures/nx_(1).png', // Left face
  isMobile ? 'js/py_(1).webp' : 'textures/py_(1).png', // Top face
  isMobile ? 'js/ny_(1).webp' : 'textures/ny_(1).png', // Bottom face
  isMobile ? 'js/pz_(1).webp' : 'textures/pz_(1).png', // Front face
  isMobile ? 'js/nz_(1).webp' : 'textures/nz_(1).png'  // Back face
    ]);

    // Set Initial Background Cube Map
    scene.background = dayCubeMap;

// Toggle between Day/Night Textures and Cube Map
    function toggleDayNight() {
      if (isDay) {
        globe2.material.map = nightTexture;
        scene.background = nightCubeMap;
        document.getElementById("toggleButton").textContent = "Switch to Day";
        document.getElementById("dayTicker").style.display = "none";
        document.getElementById("nightTicker").style.display = "block";
      } else {
        globe2.material.map = dayTexture;
        scene.background = dayCubeMap;
        document.getElementById("toggleButton").textContent = "Switch to Night";
        document.getElementById("dayTicker").style.display = "block";
        document.getElementById("nightTicker").style.display = "none";
      }
      globe2.material.needsUpdate = true;
      isDay = !isDay;
    }

// Add Event Listener to the Toggle Button
    document.getElementById('toggleButton').addEventListener('click', toggleDayNight);

    // Load Textures
  //const textureLoader = new THREE.TextureLoader();
  //const dayTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-blue-marble.jpg");
  //const nightTexture = textureLoader.load("//unpkg.com/three-globe/example/img/earth-night.jpg");
  //const bumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
  //const specularMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-water.png");
		//const dayBumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
//const nightBumpMap = textureLoader.load("//unpkg.com/three-globe/example/img/earth-topology.png");
  

  
  //const textureLoader = new THREE.TextureLoader();
  const shaderMaterial = new THREE.ShaderMaterial({});

  const material = new THREE.ShaderMaterial({
    vertexShader: `
                varying vec2 vertexUV;
                varying vec3 vertexNormal;
                   void main() {
                        vertexUV = uv;
                        vertexNormal = normalize(normalMatrix * normal);
                       gl_Position = projectionMatrix
                       * modelViewMatrix
                       * vec4(position, 1);
                     }
                    `,
    fragmentShader: `
                    uniform sampler2D globeTexture;
                    uniform sampler2D bumpMap;
                    uniform sampler2D bumpScale;
                    uniform sampler2D specularMap;
                    uniform sampler2D specular;
                    uniform sampler2D shininess;
                    varying vec2 vertexUV;
                    varying vec3 vertexNormal;
                     void main() {
                     float intensity = 1.05 - dot(
                     vertexNormal, vec3(0, 0, 1.0));
                     vec3 atmosphere = (vec3(0.3, 0.6, 1.0))
                     * pow(intensity, 1.5);
                        gl_FragColor = vec4(atmosphere +texture2D(globeTexture, vertexUV).xyz, 1.0),
                         vec4(atmosphere +texture2D(bumpMap, vertexUV).xyz, 2.0);
                     }
                    `,

    uniforms: {
      /*"color": { value: new THREE.Color( 0xffffff ) },
  			"diffuse": { value: new THREE.Color( 0xffffff ) },*/
      specular: { value: new THREE.Color("grey") },
      /*"emissive": { value: new THREE.Color( 0x000000 ) },
  			"opacity": { value: 1 },*/
      shininess: { value: 15 },
      bumpMap: {
        value: new THREE.TextureLoader().load(
          "//unpkg.com/three-globe/example/img/earth-topology.png"
        ),
      },

      bumpScale: {
        value: 10,
      },

      specularMap: {
        value: new THREE.TextureLoader().load(
          "//unpkg.com/three-globe/example/img/earth-water.png"
        ),
      },
      globeTexture: {
        value: "",
      },
      /*bump: {
                          value: new THREE.TextureLoader().load("//unpkg.com/three-globe/example/img/earth-topology.png")
                          }*/
    },
  });

  const atmosphere = new THREE.Mesh(
    new THREE.SphereGeometry(5.1, 32.1, 32.1),
    new THREE.ShaderMaterial({
      vertexShader: `
                varying vec3 vertexNormal;
                   void main() {
                        vertexNormal = normalize(normalMatrix * normal);
                       gl_Position = projectionMatrix
                       * modelViewMatrix
                       * vec4(position, 1);
                     }
                    `,
      fragmentShader: `
                varying vec3 vertexNormal;
                    void main() {
                    float intensity = pow(0.6 - dot(
                     vertexNormal, vec3(0, 0, 1.0)), 2.0);
                     gl_FragColor = vec4(0.3, 0.6, 1.0, 1.0) * intensity;
                    }
                    `,
	    transparent: true, 
      blending: THREE.AdditiveBlending,
      side: THREE.BackSide,
    })
  );
	atmosphere.scale.set(1.1, 1.1, 1.1);

	  let globe = new THREE.Mesh(geometry2, material);
  //let globe2 = new THREE.Mesh(geometry, material2);
  scene.add(atmosphere);
  scene.add(globe);
  scene.add(globe2);
  // custom globe material
  const globeMaterial = globe.material;
  material.bumpScale = 10;
  new THREE.TextureLoader().load(
    "//unpkg.com/three-globe/example/img/earth-water.png",
    (texture) => {
      globeMaterial.specularMap = texture;
      globeMaterial.specular = new THREE.Color("grey");
      globeMaterial.shininess = 15;
    }
  );
	  setTimeout(() => {
    // wait for scene to be populated (asynchronously)
    var dl = new THREE.DirectionalLight(0xffffff, 1);
    dl.position.set(1, 1, 1);
    //scene.add(dl); // change light position to see the specularMap's effect
  });
  // White directional light at half intensity shining from the top.
  const directionalLight = new THREE.DirectionalLight(0x909090, 1);
  directionalLight.position.set(-1, -1, -1);
  scene.add(directionalLight);
  var dl2 = new THREE.DirectionalLight(0xffffff, 1);
  dl2.position.set(0, 1, 1);
  //scene.add(dl2); // change light position to see the specularMap's effect
  var dl3 = new THREE.DirectionalLight(0xffffff, 1);
  dl3.position.set(3, 2, 1);
  //scene.add(dl3);
  const light2 = new THREE.AmbientLight(0x808080); // soft white light
  scene.add(light2);

  var light = new THREE.DirectionalLight(0xf0f0f0, 1);
  light.position.set(5, 3, 5);
  scene.add(light);
    // Markers Data
	  // Markers Data
    const markersData = [
      {
        //Africa
      id: 1,
      position: [5.1, 1.2, 1.5],
      iframeSrc: "https://rss.app/embed/v1/carousel/dIqCIlIGNRu8C6sq",
      },
      // More markers...
	    {
        //Europe
      id: 2,
      position: [5.1, 0.7, 1.8],
      iframeSrc: "https://rss.app/embed/v1/carousel/dIqCIlIGNRu8C6sq",
      },
	     {
        //America
      id: 3,
      position: [5.1, 0.9, 0],
      iframeSrc: "https://rss.app/embed/v1/carousel/j4Lz0RvN9tozg8ti",
      },
	    {
        //South America
      id: 4,
      position: [5.1, 1.6, 0.4],
      iframeSrc: "https://rss.app/embed/v1/carousel/egKZAx1vbuN40QJ5",
      },
	    {
        //Middle East
      id: 5,
      position: [5.1, 1, 2.3],
      iframeSrc: "https://rss.app/embed/v1/carousel/QtI2HAU7LB5FfP93",
      },
	    {
        //Asia
      id: 6,
      position: [5.1, 0.9, 3],
      iframeSrc: "https://rss.app/embed/v1/carousel/dwbg7NploOubDAzi",
      },
	    {
        //Japan
      id: 7,
      position: [5.1, 0.9, 4],
      iframeSrc: "https://rss.app/embed/v1/carousel/H7fYbpNYSCQC0Kob",
      },
	    {
        // Jamaica
      id: 8,
      position: [5.1, 1.2, 0.2],
      iframeSrc: "https://rss.app/embed/v1/carousel/t8w4T1GZ8wZ4bHWQ",
      },
	     {
        //UK
      id: 9,
      position: [5.1, 0.6, 1.45],
      iframeSrc: "https://rss.app/embed/v1/carousel/h02Ux8iXmbwRcpWU",
      },
    ];
	  /*
  const markersData = [
    {
      //Africa
      id: 1,
      position: [5.1, 1.2, 1.5],
      iframeSrc: "https://rss.app/embed/v1/carousel/dIqCIlIGNRu8C6sq",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"lazy",
      width:"250",
      height:"249",
      scrolling:"no",
      allowfullscreen:"true"
    },
    // ... Add other markers here
    {
      //Europe
      id: 2,
      position: [5.1, 0.7, 1.8],
      iframeSrc: "https://rss.app/embed/v1/carousel/dIqCIlIGNRu8C6sq",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"lazy",
      width:"250",
      height:"249",
      scrolling:"no",
      allowfullscreen:"true"
    },
    {
      //America
      id: 3,
      position: [5.1, 0.9, 0],
      iframeSrc: "https://rss.app/embed/v1/carousel/j4Lz0RvN9tozg8ti",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"lazy",
      width:"250",
      height:"249",
      scrolling:"no",
      allowfullscreen:"true"
    },
    {
      //South America
      id: 4,
      position: [5.1, 1.6, 0.4],
      iframeSrc: "https://rss.app/embed/v1/carousel/egKZAx1vbuN40QJ5",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"lazy",
      width:"250",
      height:"249",
      scrolling:"no",
      allowfullscreen:"true"
    },
    {
      //Middle East
      id: 5,
      position: [5.1, 1, 2.3],
      iframeSrc: "https://rss.app/embed/v1/carousel/QtI2HAU7LB5FfP93",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"lazy",
      width:"250",
      height:"249",
      scrolling:"no",
      allowfullscreen:"true"
    },
    {
      //Asia
      id: 6,
      position: [5.1, 0.9, 3],
      iframeSrc: "https://rss.app/embed/v1/carousel/dwbg7NploOubDAzi",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"lazy",
      width:"250",
      height:"249",
      scrolling:"no",
      allowfullscreen:"true"
    },
    {
      //Japan
      id: 7,
      position: [5.1, 0.9, 4],
      iframeSrc: "https://rss.app/embed/v1/carousel/H7fYbpNYSCQC0Kob",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"lazy",
      width:"250",
      height:"249",
      scrolling:"no",
      allowfullscreen:"true"
    },
    {
      // Jamaica
      id: 8,
      position: [5.1, 1.2, 0.2],
      iframeSrc: "https://rss.app/embed/v1/carousel/t8w4T1GZ8wZ4bHWQ",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"lazy",
      width:"250",
      height:"249",
      scrolling:"no",
      allowfullscreen:"true"
    },
    {
      //UK
      id: 9,
      position: [5.1, 0.6, 1.45],
      iframeSrc: "https://rss.app/embed/v1/carousel/h02Ux8iXmbwRcpWU",
      sandbox:"allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-popups-to-escape-sandbox",
      frameborder:"0",
      loading:"lazy",
      width:"250",
      height:"249",
      scrolling:"no",
      allowfullscreen:"true"
    },
  ];*/
	  
    // Labels and markers
    const labelsContainer = document.getElementById("labels-container");
    const markerObjects = [];

    markersData.forEach((marker) => {
      // Create label for marker
      const labelDiv = document.createElement("div");
      labelDiv.className = "marker-label";
      labelDiv.id = `label-${marker.id}`;

      const iframe = document.createElement("iframe");
      iframe.src = marker.iframeSrc;
      iframe.width = "250";
      iframe.height = "250";
      iframe.frameBorder = "0";
      labelDiv.appendChild(iframe);

      // Append label to container
      labelsContainer.appendChild(labelDiv);

      // Create marker object
      const markerObject = new THREE.Object3D();
      const sphericalPosition = new THREE.Spherical(5.1, marker.position[1], marker.position[2]);
      markerObject.position.setFromSpherical(sphericalPosition);
      scene.add(markerObject);

      markerObjects.push({ labelDiv, markerObject, worldPosition: markerObject.position.clone() });
    });

    // Raycaster setup
    const raycaster = new THREE.Raycaster();
    const pointer = new THREE.Vector2();

    function onPointerMove(event) {
      pointer.x = (event.clientX / window.innerWidth) * 2 - 1;
      pointer.y = -(event.clientY / window.innerHeight) * 2 + 1;
    }

    window.addEventListener("pointerdown", onPointerClick);

    function onPointerClick(event) {
      onPointerMove(event);
      raycaster.setFromCamera(pointer, camera);

      const intersects = raycaster.intersectObjects(markerObjects.map(m => m.markerObject));

      if (intersects.length > 0) {
        const intersectedMarker = intersects[0].object;
        const clickedMarker = markerObjects.find(m => m.markerObject === intersectedMarker);

        if (clickedMarker) {
          clickedMarker.labelDiv.classList.add("active");
          controls.autoRotate = false;
        }
      }
    }

    // Update marker labels' opacity based on distance from camera
    function updateMarkerLabelOpacity() {
      markerObjects.forEach(markerObj => {
        const { labelDiv, worldPosition } = markerObj;

        const markerPos = worldPosition.clone().project(camera);
        const distance = camera.position.distanceTo(worldPosition);

        let opacity = 1 - (distance / 20); // Adjust fade-out based on distance
        opacity = Math.max(0, Math.min(opacity, 1));

        labelDiv.style.opacity = opacity;

        const x = (markerPos.x * 0.5 + 0.5) * window.innerWidth;
        const y = -(markerPos.y * 0.5 - 0.5) * window.innerHeight;
        labelDiv.style.transform = `translate(-50%, -50%) translate(${x}px, ${y}px)`;
      });
    }

    // Animation loop
    function animate() {
      requestAnimationFrame(animate);
      controls.update();
      updateMarkerLabelOpacity();
      renderer.render(scene, camera);
    }
	  
    animate();
	  
    
    
  </script>
</body>
</html>
